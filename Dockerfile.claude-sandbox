# Dockerfile для безопасного запуска Claude CLI в изолированном окружении
FROM node:20-slim

# Устанавливаем минимальный набор утилит
RUN apt-get update && apt-get install -y \
    sqlite3 \
    && rm -rf /var/lib/apt/lists/*

# Создаем непривилегированного пользователя
RUN useradd -m -u 1000 -s /bin/bash claudeuser

# Создаем рабочую директорию
RUN mkdir -p /workspace && chown claudeuser:claudeuser /workspace

# Устанавливаем Claude CLI глобально через npm
RUN npm install -g @anthropic-ai/claude-code

# Переключаемся на непривилегированного пользователя
USER claudeuser
WORKDIR /workspace

# Команда по умолчанию - ждать команд
CMD ["tail", "-f", "/dev/null"]
